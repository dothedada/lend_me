<%- include("partials/head.ejs", { headTitle: `${ user.name} | Books` })%>
<body>
	<%- include("partials/header.ejs") %>

	<main>
		<section>
			<h2>Random Picks</h2>
			<div class="cards_display">
				<% friendsBooks.forEach((book) => { %>
				<div class="card">
					<div>
						<h3><a href="/detail/<%= book.id %>/book"><%= book.title %></a></h3>
						<div><a href="/detail/<%= book.author_id %>/author"><%= book.author %></a></div>
						<small>Owned by: <%= book.owner %></small>
					</div>

					<form action="/lends/request" method="post">
						<input type="hidden" name="book_id" value="<%= book.id %>">
						<input type="hidden" name="owner_id" value="<%= book.owner_id %>">
						<button>Borrow</button>
					</form>
				</div>
				<% }) %>
			</div>
		</section>

		<section>
			<h2>Search within your friends books</h2>
			<form action="/search" method="get" autocomplete="off">
				<label>
					look for...
					<input type="search" name="q">
					<button>search</button>
				</label>
			</form>
		</section>

		<section>
			<h2>My books</h2>
				<table>
					<tr>
						<th>Title</th>
						<th>Author</th>
						<th>Editorial</th>
						<th>Action</th>
					</tr>
					<% userBooks.forEach((book) => { %>
					<tr>
						<td><a href="/detail/<%= book.id %>/book"><%= book.title %></a></td>
						<td><a href="/detail/<%= book.author_id %>/author"><%= book.author %></a></td>
						<td><a href="/detail/<%= book.editorial_id %>/editorial"><%= book.editorial || "" %></a>
						</td>
					

						<td>
							<form action="/books/<%= book.id %>/remove" method="post">
								<button class="outline">remove from library</button>
							</form>
						</td>
					</tr>
					<% }) %>
				</table>
		<section>

		<section>
			<h2>Add a new book to my library...</h2>
			<form action="/books/add" method="post" autocomplete="off">
				<label>
					Book title
					<input type="text" list="titles" name="title" placeholder="The Craftsman">
					<datalist id="titles">
						<% titles.forEach((title) => { %> 
							<option>
								<%= title %>
							</option>
						<% }) %>
					</datalist>
				</label>
				<button>Add</button>
			</form>
		</section>
	</main>

	<%- include("partials/footer.html") %>
</body>
</html>
